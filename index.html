<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Retransfy</title>
    <style>
      body {
        background-image: url("media/cover.jpg");
        background-color: orange;
        background-size: cover;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
      }

      #container {
        background-color: rgba(255, 255, 255, 0.95);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0px;
        padding: 20px;
        border-radius: 20px;
        box-shadow: 2px 2px 4px rgb(73, 73, 73, 0.3);
        height: auto;
      }

      textarea {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 16px;
      }

      #create,
      #copyButton {
        background-color: darkred;
        color: white;
        padding: 5px;
        border-style: none;
        box-shadow: 2px 2px 4px rgb(73, 73, 73, 0.3);
        cursor: pointer;
      }

      #goBack {
        display: block;
        margin-top: 10px;
        background-color: rgb(255, 196, 0);
        padding: 10px;
        border-style: none;
        color: rgb(0, 0, 0);
        box-shadow: 2px 2px 4px rgb(73, 73, 73, 0.3);
      }

      a {
        text-decoration: none;
        cursor: pointer;
      }

      #titled {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans",
          "Helvetica Neue", sans-serif;
        text-align: center;
        background-color: #03574b;
        font-size: 14px;
        padding: 10px;
        border-radius: 10px;
        color: white;
      }
    </style>
  </head>
  <div id="container">
    <p id="titled">
      Sender-Receiver-Amount received<br />
      Amount sent-Fee-Total-TRX ID
    </p>
    <form action="" id="receipt">
      <textarea name="receiptarea" id="receiptarea" cols="32" rows="15" autofocus></textarea>
      <br />
      <button type="submit" id="create">Create receipt</button>
    </form>
    <div id="receiptOutput"></div>
    <!-- Add this button inside your form -->
    <button type="button" id="copyButton" style="display: none">Copy Receipt</button>
    <br />
    <a href="index.html"><button type="button" id="goBack" style="display: none">Go Back</button></a>
  </div>

  <script>
    let copyButton = document.getElementById("copyButton");
    let goBack = document.getElementById("goBack");
    document.getElementById("receipt").addEventListener("submit", function (event) {
      event.preventDefault();

      // Get the value entered in the textarea
      const textareaValue = document.getElementById("receiptarea").value;

      // Split the textarea value into lines
      const lines = textareaValue.split("\n");

      // Extract data from each line
      const sender = lines[0].replace("Sender: ", "");
      const receiver = lines[1].replace("Receiver: ", "");
      const amountToReceive = lines[2].replace("Amount to receive: ", "");
      const amountToSend = lines[3].replace("Amount to Send: ", "");
      const fee = lines[4].replace("Fee: ", "");
      const totalAmount = lines[5].replace("Total Amount: ", "");
      const trxId = lines[6].replace("TRX ID: ", "");

      // Get the current date and time
      const currentDate = new Date();
      const formattedDate = currentDate.toLocaleDateString();
      const formattedTime = currentDate.toLocaleTimeString();

      // Generate receipt with date and time
      const receiptText = `
<p>Transaction successful</p>
<p>Sender: ${sender}</p>
<p>Receiver: ${receiver}</p>
<p>Amount received: ${amountToReceive}</p>
<p>Amount sent: ${amountToSend}</p>
<p>Fee: ${fee}</p>
<p>Total Amount: ${totalAmount}</p>
<p>TRX ID: ${trxId}</p>
<p>Date: ${formattedDate} | ${formattedTime}</p>`;

      // Display receipt
      document.getElementById("receiptOutput").innerHTML = receiptText;
      copyButton.style.display = "block";
      goBack.style.display = "block";
      document.getElementById("receiptarea").style.display = "none";
      document.getElementById("create").style.display = "none";

      // Add a click event listener to the "Copy Receipt" button
      copyButton = document.getElementById("copyButton");
      copyButton.addEventListener("click", function () {
        // Create a textarea element to temporarily hold the text to copy
        const textArea = document.createElement("textarea");
        textArea.value = receiptText.replace(/<[^>]*>/g, "");

        // Append the textarea to the document
        document.body.appendChild(textArea);

        // Select and copy the text
        textArea.select();
        document.execCommand("copy");

        // Remove the temporary textarea
        document.body.removeChild(textArea);
      });
    });
  </script>

  <body></body>
</html>
